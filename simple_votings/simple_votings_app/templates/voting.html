{% extends  'base.html' %}

{% block main %}
    <div class="card mt-3">
        <div class="card-body">
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <h4 class="text-left">{{ voting.text }}</h4>
                    </div>
                    <div class="col text-right">
                        {% if voting.user == user %}
                            <a href="/voting/{{ voting.id }}/edit" class="btn btn-sm btn-primary">Редактировать</a>
                        {% endif %}
                    </div>
                </div>
                {% for answer in voting.answers %}
                    <hr>
                    <form method="post" action="{{ answer.action }}">
                        {% csrf_token %}
                        <input type="submit" value="{{ answer.text }} - Проголосовало {{ answer.votes_count }}"
                               class="btn btn-outline-primary btn-block text-left"
                                {% if not voting.is_multiple %}
                                    {% if voted_answers %}
                               disabled
                                    {% endif %}
                                {% else %}
                                    {% if answer in voted_answers %}
                               disabled
                                    {% endif %}
                                {% endif %}>
                    </form>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="card-footer">
        <div class="d-flex justify-content-between">
            <div>
                <style>
                    .text-muted {
                        margin-right: 10px;
                    }
                </style>

                <span class="text-muted">
                    Создатель <a href="/profile/{{ voting.user.id }}">{{ voting.user.username }}</a>
                </span>
                <span class="text-muted">Создан {{ voting.start_time }}</span>
                {% if voting.end_time %}
                    <span class="text-muted">Заканчивается {{ voting.end_time }}</span>
                {% endif %}
            </div>
            <div>
                <form method="post" action="{{ voting.like }}" class="hr" style="float: left; margin: 0px;">
                    {% csrf_token %}
                    <input type="submit" value="♥ {{ voting.likes_count }}" class="btn btn-outline-danger"
                           style="padding: 1px 10px;">
                </form>
            </div>
        </div>
    </div>
    <hr style="margin: 0px;">

    <h3>Добавить комментарий:</h3>
    <form method="post" action="/voting/{{ voting.id }}">
        {% csrf_token %}
        {{ form.comment }}
        <input class="btn btn-primary" type="submit" value="Оставить комментарий">
    </form>
    <h3>Комментарии:</h3>
    {% if voting.comments %}
        {% for comment in voting.comments %}
            <div style="background-color: #F0F8FF; margin: 1px;">
                <h4>{{ comment.user.username }}:</h4>
                <p>{{ comment.text }}</p>
                <p>Создан в {{ comment.date }}</p>
            </div>
        {% endfor %}
    {% else %}
        <p>Комментариев нет</p>
    {% endif %}
    </div>
{% endblock %}